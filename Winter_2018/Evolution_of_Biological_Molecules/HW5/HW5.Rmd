---
title: "Homework_5"
author: "Justin Rigby"
date: "5 March 2018"
output: html_document
---
  
1.  
a)  
cd /home/justin/Desktop/graduateschoolclasses/Winter_2018/Evolution_of_Biological_Molecules/HW5/data  
load TEM1-imipenem-from-1BT5.pse  
hide everything  
bg_color white  
show cartoon, TEM-1  
show cartoon, imipenem  
color gray70, TEM-1  
color black, imipenem   
cd ../src  
python getRelativeSolventAccessibility.py  
  
8 Residues  
35, 126, 134, 135, 187, 232, 248, and 249.  
  
b)  
```{r}
site.diversity <- read.delim("~/Desktop/graduateschoolclasses/Winter_2018/Evolution_of_Biological_Molecules/HW5/data/site-diversity.txt", comment.char="#")

solvent <- read.delim("~/Desktop/graduateschoolclasses/Winter_2018/Evolution_of_Biological_Molecules/HW5/solvent.txt")

RSA <- solvent$rsa
num_aa <- site.diversity$num.aas

plot(num_aa, RSA, xlab= "Number of Amino Acids") + abline(lm(RSA ~ num_aa))
```
  
c)  
  
```{r}
cor.test(num_aa, RSA, method = 'spearman')
```
  
From the results we can see that there is not a correlation between the amino acid diversity at a site and the amount of solvent accesibly the residue is exposed to. Evolutionarily speaking, there is no relationship between the rate of amino acid changes and the expouser to solvent in the cell.  
  
d)  
This relationship may exist soley by the fact that these sites may not be influenced by the solvent exposer level enough to warrant a selection for specific amino acids, and may instead just change because of neutral evolution.  
  
2.  
Residues  
44, 45, 46, 47, 48, 49, 50, 57, 58, 59, 60, 230, 231, 232, 233, 234, 235, 236, 237, 238, 240, 243, 244, 245, 246, 247, 248, 249, 250, 251, 258, 259, 260, 261, 262, 263, 264, 265  
  
```{r}
minor.sheet.propensities <- read.delim("~/Desktop/graduateschoolclasses/Winter_2018/Evolution_of_Biological_Molecules/HW5/data/minor-sheet-propensities.txt",fill = TRUE, comment.char="#")
#Residues of the Beta Sheets in TEM-1
b_sheet_resi <- c(44, 45, 46, 47, 48, 49, 50, 57, 58, 59, 60, 230, 231, 232, 233, 234, 235, 236, 237, 238, 240, 243, 244, 245, 246, 247, 248, 249, 250, 251, 258, 259, 260, 261, 262, 263, 264, 265) 

#Single letter amino acid
aas = c("A", "C", "D", "E", "F", "G", "H", "I", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "V", "W", "Y")

#Reading the proportions of amino acids at each site in the protein
aaprop <- read.table('/home/justin/Desktop/graduateschoolclasses/Winter_2018/Evolution_of_Biological_Molecules/HW5/data/site-aa-proportion.txt', header = T)

#Matching the amino acid proportions found at each residue in the beta sheets
aaprop.sheets <- aaprop[match(b_sheet_resi, aaprop$site),]
#Determining the mean value of each of the amino acids in beta sheets from the matched vector
mean.aaprop.sheets <- colMeans(aaprop.sheets, na.rm = T)

#Plotting the proportion of amino acids in beta sheets
plot(mean.aaprop.sheets[2:21], minor.sheet.propensities$ddg, pch = aas, xlab = "Amino Acid Proportion in B-Sheets", ylab = 'Propensities of Amino Acids', main = 'Alpha Helices')

```
  
  
  
  
  
b)
  
  
  
  
  
  
  
```{r}

helix_propensities <- read.delim("~/Desktop/graduateschoolclasses/Winter_2018/Evolution_of_Biological_Molecules/HW5/data/pace-helix-propensities.txt", fill = TRUE)

a_helix_resi <- c(27,28,29,30,31,32,33,34,35,36,37,38,39,40,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,99,100,101,108,109,110,111,119,120,121,122,123,124,125,126,127,128,132,133,134,135,136,137,138,139,140,141,142,145,146,147,148,149,150,151,152,153,154,155,167,168,169,170,183,184,185,186,187,188,189,190,191,192,193,194,195,201,202,203,204,205,206,207,208,209,210,211,212,213,221,222,223,224,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289)

#Single letter amino acid
aas = c("A", "C", "D", "E", "F", "G", "H", "I", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "V", "W", "Y")

#Reading the proportions of amino acids at each site in the protein
aaprop <- read.table('/home/justin/Desktop/graduateschoolclasses/Winter_2018/Evolution_of_Biological_Molecules/HW5/data/site-aa-proportion.txt', header = T)

#Matching the amino acid proportions found at each residue in the alpha helices
aaprop.helix <- aaprop[match(a_helix_resi, aaprop$site),]
#Determining the mean value of each of the amino acids in beta sheets from the matched vector
mean.aaprop.helix <- colMeans(aaprop.helix, na.rm = T)

#Plotting the proportion of amino acids in beta sheets
plot(mean.aaprop.helix[2:21], helix_propensities$ddg, pch = aas, xlab = "Amino Acid Proportion in A-Helices", ylab = 'Propensities of Amino Acids')

```  
  
  
c)  
  
$\Delta G_u = 21 \frac{kJ}{mol}$  
$\Delta G = -RTln(K_{eq})=> K_{eq} = e^{-\frac{\Delta G}{RT}}$  
  
a)  
$K_eq = e^{-\frac{5}{0.5961611}} = e^{-8.386995} = 0.0002093908$  
$\therefore K_{eq} = 0.0002278108$  
  
  
d)  
  
```{r}

dd_gu <- seq(-4, 1, by = 0.1)

k_eq <- function(dd_gu){
  
k_eqs <- exp(-(5+dd_gu)/0.5961611)
return(k_eqs)
}

k_eq_results <- k_eq(dd_gu)

plot(dd_gu, k_eq_results, xlab ='Delta Delta Gu', ylab = 'K_eq', main = 'K_eq as a Function of Delta Delta Gu')
  
```  
  
  
4.  
  
a)  
  
$\beta = \alpha [P]_0 k_{cat = 1 h^-1}$  
$r = \alpha [P]_0 Pr_{fold}k_{cat} \Delta G_u = \beta \Delta G_uPr_{fold}$  
  
$Pr_{fold} = \frac{1}{1+e^{-\frac{\Delta G*\Delta \Delta G_{u D->E}}{RT}}}$  
  
$r = 1 * (\Delta G*\Delta \Delta G_{u D->E})*\frac{1}{1+e^{-\frac{\Delta G*\Delta \Delta G_{u D->E}}{RT}}} = \frac{(\Delta G*\Delta \Delta G_{u D->E})}{1+e^{-\frac{\Delta G*\Delta \Delta G_{u D->E}}{RT}}}$
  
  
  
b)  
  
```{r}
d_gu <- 5
dd_gu <- 0



s_i <- function (d_gu, dd_gu){
s_u <- (1-
(exp(
  (d_gu+dd_gu)/
    (1+exp(-(d_gu+dd_gu)/(0.5961611)
      
      
      
      )))))
return(s_u)
}  
  
s_i(d_gu, dd_gu)  
```
  
c)  
  
```{r}

dGu <- 0

pfold <- function(dGu){
k_eq <- exp(-(dGu)/2.478956)
return(k_eqs)
}

pfix.naive <- function(s,N){
((1-exp(-2*s))/(1-exp(-2*N*s)))
}

pfix <- function(s,N){
p <- sapply(s, function(the.s){
if (abs(the.s) > .Machine$double.eps){
  p = ((1-exp(-2*the.s))/(1-exp(-2*N*the.s)))
}  
else {
  p = 1/N
}  
})
p  
}

eq.fix <- function(ddGu, dGu, N){
  
  
}






```

  
  